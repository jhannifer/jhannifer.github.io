webpackJsonp([49683490770531],{448:function(n,a){n.exports={data:{site:{siteMetadata:{title:"Jhannifer Oliveira | Arquiteta e Urbanista",description:"Site e portfólio da Arquiteta e Urbanista Jhannifer Oliveira",url:"https://jhannifer.com.br",author:"jhanniferoliveira"}},remark:{posts:[{post:{html:'<p>Welcome to the second part of the series, where I will show you how to get the network and CPU information of your machines with the Node.js OS API. If you have not read the first part which introduces you to the OS API yet, you can find it <a href="/blog/playing-with-nodejs-part-1/">here</a>. </p>\n<!-- more -->\n<hr>\n<h3>Collect network information</h3>\n<p>Search “How to get IP address in nodejs” on Google and people will suggest you to install the <code>ip</code> library. Very clean solution indeed, but why should we install extra package when the Node.js API gives you this, the <code>os.networkInterfaces()</code> method. </p>\n<p>First, import the <code>os</code> package then call the desired method.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// import OS API</span>\n<span class="token keyword">const</span> interfaces <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">networkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Run the code via the terminal and see the result:</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 630px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 111.90476190476191%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeFNwYC4AD//xAAVEAEBAAAAAAAAAAAAAAAAAAAQQf/aAAgBAQABBQKEIf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABkQAQEBAAMAAAAAAAAAAAAAAAEAEBFhgf/aAAgBAQABPyEntzETpwrn/9oADAMBAAIAAwAAABCTDwD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAEBAAIDAQAAAAAAAAAAAAABEQAhEDFR0f/aAAgBAQABPxCEq7x7+sr1zqpXeNdBxMU9xC6Jx//Z&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="part-2-network-1" title="" src="/static/465c00bc3f124cc361293d494dddc823-850f2.jpg" srcset="/static/465c00bc3f124cc361293d494dddc823-13955.jpg 188w,\n/static/465c00bc3f124cc361293d494dddc823-d0ba3.jpg 375w,\n/static/465c00bc3f124cc361293d494dddc823-850f2.jpg 630w" sizes="(max-width: 630px) 100vw, 630px">\n    </span>\n  </span>\n  \n    Pic 1.1: List of network interfaces\n</div></body></html>\n<p>It can be seen that my Window machine has 3 network interfaces in total: </p>\n<ul>\n<li><strong>etho0</strong>: the ethernet network.</li>\n<li><strong>lo</strong>: the loopback interface.</li>\n<li><strong>wifi0</strong>: the wireless network.</li>\n</ul>\n<p>As the result, calling the <code>os.networkInterfaces()</code> method will return an object containing all network interfaces under the your operating system, each interface is an array with 2 item which represents the IPv4 and IPv6 data respectively. The next step is to extract the public IP of our machines which, in my case, is the IPv4 address of the wireless network.</p>\n<p>Question: how to retrieve one object out of a mess? The answer is <code>map</code> and <code>filter</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token comment" spellcheck="true">// Since the interfaces variable is an object, not an array so map and filter can not be used on it. </span>\n<span class="token comment" spellcheck="true">// Instead, we will extract each network interface inside the interfaces object and put them into a seperate array.</span>\n<span class="token keyword">const</span> interfaces <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">networkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> networks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// Apply Objects.keys to interfaces variable in order to use the map method</span>\n<span class="token keyword">let</span> result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>interfaces<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=></span> <span class="token punctuation">{</span> \n    interfaces<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x1 <span class="token operator">=></span> <span class="token punctuation">{</span>\n    networks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// Once we got the array of intefaces, use filter to bring out the piece of data that we want</span>\n<span class="token keyword">let</span> theChosenOne <span class="token operator">=</span> networks<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>x <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span> x<span class="token punctuation">.</span>internal <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>family <span class="token operator">===</span> <span class="token string">\'IPv4\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// Because I want to get the public IPv4 address</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>theChosenOne<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Run the code again and ta-da, I have successfully obtain an object that holds all information that I need such as the public IPv4 address, the MAC address, etc.</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 626px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 20.60702875399361%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABw5gB/8QAFRABAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQEAAQUCh//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABYQAAMAAAAAAAAAAAAAAAAAAAAQEf/aAAgBAQABPyFKf//aAAwDAQACAAMAAAAQ88//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAADAQEAAAAAAAAAAAAAAAAAARFRQf/aAAgBAQABPxBK12YNvStZ/9k=&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="part-2-network-2" title="" src="/static/fa30bbd897de008cacd6a8c94ec9e55b-93538.jpg" srcset="/static/fa30bbd897de008cacd6a8c94ec9e55b-5f646.jpg 188w,\n/static/fa30bbd897de008cacd6a8c94ec9e55b-8d5b6.jpg 375w,\n/static/fa30bbd897de008cacd6a8c94ec9e55b-93538.jpg 626w" sizes="(max-width: 626px) 100vw, 626px">\n    </span>\n  </span>\n  \n    Pic 1.2: The final result.\n</div></body></html>\n<p><strong>Note: If you are connecting both ethernet and wireless interfaces to the Internet then the above code will result in an array of 2 items. Some external program like Docker will create a virtual ethernet interface which exposes itself to the Internet and thus, produce the same side effect when you execute the code.</strong></p>\n<hr>\n<h3>Collect CPU information</h3>\n<p>In the final chapter of this series, we will look at the brain of every computers, the CPU. The only method we will be using is os.cpus() and it provides nearly everything we want to know about the CPU.</p>\n<p>As usual, import the <code>os</code> package then call <code>os.cpus()</code>:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cpus <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cpus<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Run the <code>index.js</code> file via the terminal:</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 631px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 97.14738510301109%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeFNSYC4AD//xAAWEAEBAQAAAAAAAAAAAAAAAAAQQUL/2gAIAQEAAQUChDJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGxAAAgEFAAAAAAAAAAAAAAAAABARAWFxgZH/2gAIAQEAAT8hyJuSanFRv//aAAwDAQACAAMAAAAQ4wgA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRAAAQMFAQAAAAAAAAAAAAAAAQARURAhMYGRQf/aAAgBAQABPxB7SWFoTocTpK0WwfVrqgAka//Z&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="part-2-cpu-1.png" title="" src="/static/7534271b1fa501705bc7843cfa88e5ad-b35cf.jpg" srcset="/static/7534271b1fa501705bc7843cfa88e5ad-45ae1.jpg 188w,\n/static/7534271b1fa501705bc7843cfa88e5ad-4cbfb.jpg 375w,\n/static/7534271b1fa501705bc7843cfa88e5ad-b35cf.jpg 631w" sizes="(max-width: 631px) 100vw, 631px">\n    </span>\n  </span>\n  \n    Pic 2.1: CPU information.\n</div></body></html>\n<p>From the <code>model</code> attribute, we can already deduce the CPU model which, on my machine, is the Intel Skylake, Core i5, model 6200U 2.3Ghz with 2 Cores and 4 Threads.</p>\n<p>The <code>times</code> attribute contains some interesting numbers and the documentation did explain a bit about what these numbers are so I will not talk about their meanings here; instead, I will show you how to calculate the almost-real-time CPU usage and it should be somewhat close to the CPU utilisation number as shown in the Task Manager.</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 721px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 86.54646324549238%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHs1eWSsZRLoP/EABgQAAMBAQAAAAAAAAAAAAAAAAACEgEg/9oACAEBAAEFAowhSF7/AP/EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8BiJv/xAAWEQEBAQAAAAAAAAAAAAAAAAARABD/2gAIAQIBAT8BZ3//xAAZEAACAwEAAAAAAAAAAAAAAAABkQAgMTL/2gAIAQEABj8CwKYFOQr/AP/EABkQAAIDAQAAAAAAAAAAAAAAAAEhABARIP/aAAgBAQABPyEb3rCKCjmcf//aAAwDAQACAAMAAAAQ8McA/8QAGBEAAgMAAAAAAAAAAAAAAAAAABARUWH/2gAIAQMBAT8QyIU//8QAFxEAAwEAAAAAAAAAAAAAAAAAABFREP/aAAgBAgEBPxBqNd//xAAcEAEAAgIDAQAAAAAAAAAAAAABABExcRAh4fH/2gAIAQEAAT8QsMWk+Mj5qAWgOodC7hYG2GXfP//Z&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="part-2-cpu-2.png" title="" src="/static/8ddb687b84e6424f949a396665f624c4-5079d.jpg" srcset="/static/8ddb687b84e6424f949a396665f624c4-c7cf7.jpg 188w,\n/static/8ddb687b84e6424f949a396665f624c4-1f1d5.jpg 375w,\n/static/8ddb687b84e6424f949a396665f624c4-5079d.jpg 721w" sizes="(max-width: 721px) 100vw, 721px">\n    </span>\n  </span>\n  \n    Pic 2.1: Task Manager.\n</div></body></html>\n<p>Using the instructions <a href="https://github.com/Leo-G/DevopsWiki/wiki/How-Linux-CPU-Usage-Time-and-Percentage-is-calculated">here</a> as the reference, the code is as follows:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> currentCpuData <span class="token operator">=</span> <span class="token function">getCpuData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">// Average CPU usage since boot, this is not what we are looking for though</span>\n<span class="token comment" spellcheck="true">// but it is nice to know :)</span>\navgCpuUsage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>currentCpuData<span class="token punctuation">.</span>cpuUsage <span class="token operator">/</span> currentCpuData<span class="token punctuation">.</span>cpuTotal <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> \nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Average CPU usage since boot is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>avgCpuUsage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// The trick is to wait 1 second, then get the CPU data again.</span>\n<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> newCpuData <span class="token operator">=</span> <span class="token function">getCpuData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment" spellcheck="true">// Total CPU time difference between 2 moments</span>\n    <span class="token keyword">let</span> cpuTotalDiff <span class="token operator">=</span> newCpuData<span class="token punctuation">.</span>cpuTotal <span class="token operator">-</span> currentCpuData<span class="token punctuation">.</span>cpuTotal<span class="token punctuation">;</span>\n    <span class="token comment" spellcheck="true">// Cpu usage time difference between 2 moments</span>\n    <span class="token keyword">let</span> cpuUsageDiff <span class="token operator">=</span> newCpuData<span class="token punctuation">.</span>cpuUsage <span class="token operator">-</span> currentCpuData<span class="token punctuation">.</span>cpuUsage<span class="token punctuation">;</span>\n    <span class="token comment" spellcheck="true">// Current CPU usage, this is what we want :D</span>\n    <span class="token keyword">let</span> realCpuUsage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>cpuUsageDiff <span class="token operator">/</span> cpuTotalDiff <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Current CPU usage is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>realCpuUsage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// The piece of code being used to calculate CPU data is put into a function to avoid code redundancy.</span>\n<span class="token keyword">function</span> <span class="token function">getCpuData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> \n    <span class="token keyword">let</span> cpuTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// total CPU time since boot</span>\n    <span class="token keyword">let</span> cpuIdle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// total CPU idle time since boot</span>\n    <span class="token keyword">let</span> cpuUsage <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// total CPU usage time since boot</span>\n    os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>cpu <span class="token operator">=></span> <span class="token punctuation">{</span>\n    cpuTotal <span class="token operator">+=</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>user <span class="token operator">+</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>sys <span class="token operator">+</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>irq <span class="token operator">+</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>idle <span class="token operator">+</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>nice<span class="token punctuation">;</span>\n    cpuIdle <span class="token operator">+=</span> cpu<span class="token punctuation">.</span>times<span class="token punctuation">.</span>idle<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    cpuUsage <span class="token operator">=</span> cpuTotal <span class="token operator">-</span> cpuIdle<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>cpuTotal<span class="token punctuation">,</span> cpuUsage<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Due to many factors such as GUI delay, the result after running the code is usually not the same CPU utilisation number as shown in the Task Manager, but it should acceptably be close enough.</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 750px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 37.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAUG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAYOiEthf/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEFETP/2gAIAQEAAQUCtkZmf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAACEDFx/9oACAEBAAY/ArH2P//EABoQAAEFAQAAAAAAAAAAAAAAACEAEBFhkbH/2gAIAQEAAT8huaikI8b/2gAMAwEAAgADAAAAEAwP/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Qh//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EKf/xAAYEAEBAAMAAAAAAAAAAAAAAAABADGBof/aAAgBAQABPxBeSVpRkZrt/9k=&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="part-2-cpu-3.png" title="" src="/static/da2a4640f404e631d77cb97b93b763b6-df60d.jpg" srcset="/static/da2a4640f404e631d77cb97b93b763b6-45144.jpg 188w,\n/static/da2a4640f404e631d77cb97b93b763b6-2f941.jpg 375w,\n/static/da2a4640f404e631d77cb97b93b763b6-df60d.jpg 750w,\n/static/da2a4640f404e631d77cb97b93b763b6-b1889.jpg 1125w,\n/static/da2a4640f404e631d77cb97b93b763b6-1d6f8.jpg 1500w,\n/static/da2a4640f404e631d77cb97b93b763b6-7cb62.jpg 1680w" sizes="(max-width: 750px) 100vw, 750px">\n    </span>\n  </span>\n  \n    Pic 2.1: The CPU usage output.\n</div></body></html>\n<p>We can then use <code>setInterval</code> so that this number can be updated, for example, every 5 seconds. You can see this as an additional exercise :)</p>\n<hr>\n<h3>Summary</h3>\n<p>That is the end of this series. You now know how to obtain some basic info about the network interfaces as well as the CPU usage of your machines without having to install any external library. The Node.js OS API has many other methods that I did not cover in this series so if you are interested, visit the official documentation <a href="https://nodejs.org/api/os.html">here</a> to learn more.</p>\n<p>Thank you for reading :D</p>',frontmatter:{layout:"post",title:"Playing with Node.js OS API - Part 2",path:"/blog/playing-with-nodejs-part-2/",description:"Exploring the implementation of Node.js OS API (continued).",date:"2017/08/27"}}},{post:{html:'<p>Nowadays, Node.js is everywhere, from frontend, backend, IoT to embedded systems (check out the recent <a href="https://nodejs.org/static/documents/casestudies/Nodejs_2017_User_Survey_Exec_Summary.pdf">survey report</a> from the Node.js Foundation), all thanks to thousands of super useful open-source libraries. But what task can Node.js handle quickly without using any library? I looked at the Node.js documentation and the answer was this little gem, the <a href="https://nodejs.org/api/os.html#os_os_freemem">OS API</a>.</p>\n<!-- more -->\n<h3>Before we start</h3>\n<p>We do not need a web server for this example, but if you need one and also do not want to use any library. I suggest this <a href="https://blog.risingstack.com/your-first-node-js-http-server/">“You first Node.js HTTP server”</a> article. Otherwise, all you need is <code>package.json</code> and a <code>index.js</code> files.</p>\n<p>Also, I recommend using Node.js version <strong>>= 6.11.2</strong> in order to use most of the ES6 features without having to install any transpile tool such as Babel.</p>\n<hr>\n<h3>Collect operating system information</h3>\n<p>Let’s start by by importing the <code>os</code> module from the Node.js API to our <code>index.js</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>I will use the following provided methods from the documentation: <code>os.arch()</code>, <code>os.platform()</code> , <code>os.hostname()</code>, <code>os.type()</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">let</span> arch <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// CPU architecture </span>\n<span class="token keyword">let</span> hostname <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">hostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Hostname</span>\n<span class="token keyword">let</span> platform <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// OS platform</span>\n<span class="token keyword">let</span> type <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// OS type</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`arch method: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// return \'x64\'</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`hostname method: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hostname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> \nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`platform method: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>platform<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`type method: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Let’s see the result when I ran the code under the default Window shell as well as my favourite platform, <a href="https://msdn.microsoft.com/en-us/commandline/wsl/about">Window Subsystem for Linux aka WSL</a>:</p>\n<html><head></head><body><div class="text-center mb-2">\n    \n    Pic 1.1: Window\n</div></body></html>\n<html><head></head><body><div class="text-center mb-4">\n    \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-bottom: 1.0725rem;; max-width: 632px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 14.556962025316455%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwoAD/8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAQUCb//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABcQAAMBAAAAAAAAAAAAAAAAAAABEBH/2gAIAQEAAT8heaf/2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAQABPxBkK9K1n//Z&apos;); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image" style="width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="os-result-wsl" title="" src="/static/1075101ff789626bd5533d2bbae62a9e-2ea56.jpg" srcset="/static/1075101ff789626bd5533d2bbae62a9e-6ffca.jpg 188w,\n/static/1075101ff789626bd5533d2bbae62a9e-c0ee0.jpg 375w,\n/static/1075101ff789626bd5533d2bbae62a9e-2ea56.jpg 632w" sizes="(max-width: 632px) 100vw, 632px">\n    </span>\n  </span>\n  \n    Pic 2.1: Winow Subsystem for Linux\n</div></body></html>\n<p>So it is pretty easy to get some basic information about the CPU architecture, hostname, OS type &#x26; system platform. By using the WSL, I was able to test the code in both Linux and Window environment without much overhead <strong>(thanks Microsoft &#x3C;3)</strong>.</p>\n<hr>\n<h3>Collect RAM information</h3>\n<p>Whenever RAM is mentioned, most of us only care about the total amount of RAM and how many free RAM we have left on our computers. Node.js API got you covered by giving us the <code>os.freemem()</code> and <code>os.totalmem()</code> methods so let’s put them into our <code>index.js</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// index.js</span>\n\n<span class="token keyword">let</span> freeRam <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">freemem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Unused amount of RAM</span>\n<span class="token keyword">let</span> totalRam <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">totalmem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Total amount of RAM</span>\n<span class="token keyword">let</span> usedRam <span class="token operator">=</span> totalRam <span class="token operator">-</span> freeRam<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Simple math eh...</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`free ram: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>freeRam<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bytes ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>freeRam <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> megabytes ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>freeRam <span class="token operator">/</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> gigabytes`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`total ram: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalRam<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>totalRam <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> megabytes ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>totalRam <span class="token operator">/</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> gigabytes`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`=> used Ram = totalRam - freeRam = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>usedRam<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>usedRam <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> megabytes ~ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>usedRam <span class="token operator">/</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> gigabytes`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// Output:</span>\n<span class="token comment" spellcheck="true">// free ram: 3517329408 bytes ~ 3517 megabytes ~ 3 gigabytes</span>\n<span class="token comment" spellcheck="true">// total ram: 8429346816 ~ 8429 megabytes ~ 8 gigabytes</span>\n<span class="token comment" spellcheck="true">// => used Ram = totalRam - freeRam = 4912017408 ~ 4912 megabytes ~ 4 gigabytes</span>\n</code></pre>\n      </div>\n<p>The code is pretty straightforward:</p>\n<ol>\n<li>Get the total amount of RAM = <em>totalRam</em>.</li>\n<li>Get the unused amount of RAM = <em>freeRam</em>.</li>\n<li>Calculate the free amount of RAM by subtracting <em>freeRam</em> from <em>totalRam</em>.</li>\n<li>Convert the resulting numbers from <em>byte</em> to <em>gigabyte</em>. *</li>\n</ol>\n<p>* <em>I used 1 Gigabyte = 1,000 Megabytes = 1,000,000 Kilobytes = 1,000,000,000 Bytes so you will see the final outcome did not add up, but still close enough.</em></p>\n<hr>\n<h3>Summary</h3>\n<p>And that is it for part 1 of the series. You now know how to obtain some basic info about the underlying operating system and RAM of your computers without having to install any external library.</p>\n<p>This is my first time writing an article so many people might find my style boring and not coherent. Because of that, I would be very appreciated if you could give me some advices on what I should correct or improve (grammar, writing style, code, etc) in the comment section below. If you are still interested in this series, you can find part 2 <a href="/playing-with-nodejs-part-2">here</a>. </p>\n<p>Thank you for reading till the end :D</p>',
frontmatter:{layout:"post",title:"Playing with Node.js OS API - Part 1",path:"/blog/playing-with-nodejs-part-1/",description:"Exploring the implementation of Node.js OS API.",date:"2017/01/20"}}}]}},pathContext:{}}}});
//# sourceMappingURL=path---blog-74557a8bfec4c34a7dea.js.map